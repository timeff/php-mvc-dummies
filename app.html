<!DOCTYPE html>
<html>
    <head>
        <title>App</title>
        <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css' type='text/css'>
        <script src='https://code.jquery.com/jquery-3.1.0.min.js' integrity='sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=' crossorigin='anonymous'></script>

        <script src="http://d3js.org/d3.v3.min.js"></script> 
        <script src="http://dimplejs.org/dist/dimple.v2.0.0.min.js"></script> 
    </head>
    <body>
        <form action='javascript:send()'>
            <input name='amount' id='amount'>
            <input name='payback' id='payback'>
            <button type='submit'>Submit</button>
        </form>
        <div id='answer'></div>
        <div id='chart'></div>
        <script>
            function send(){
                var amount = $('#amount').val();
                var payback = $('#payback').val();

                $.getJSON('app.php',{amount,payback})
                .done((response)=>{
                    $('#answer').html('');
                    $('#answer').append(response.monthly_payback.monthly_payback_amount);
                    var data = response.monthly_payback;
                    
                    d3.select("svg").remove();
                    var svg1 = dimple.newSvg("#chart", 800, 400);
                    var chart1 = new dimple.chart(svg1);
                    var xAxis = chart1.addCategoryAxis("x", "Month");
                    var yAxis = chart1.addMeasureAxis("y", "THB");
                    
                    s1 = chart1.addSeries("Interest", dimple.plot.line);
                    s1.data = data['interest_per_month'];
                    s1.plot=dimple.plot.line;
                    s2 = chart1.addSeries("Principal", dimple.plot.line);
                    s2.data = data['pricipal_per_month'];
                    s2.plot=dimple.plot.line;
                    s3 = chart1.addSeries("Principal Left", dimple.plot.line);
                    s3.data = data['prin_left_per_month'];
                    s3.plot=dimple.plot.line;
                    chart1.draw(1000);
                })
                .fail(()=>{
                    console.log('Error occurs');
                })
            }

            //-----------------------------------
            


        </script>
    </body>
</html>